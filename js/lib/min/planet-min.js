var EXP=EXP||{};define(function(){var e={seed:"",color:"#50E174",tilesheet:new Image,sprites:{vegetation:{grass:{x:0,y:0}}},atmosphere:{temperature:0,toxic:!1,vegetation:{min:0,max:9}}};return e.tilesheet.src="images/tilesheets/planet/vegetation3.png",e.create=function(){return this.seed=EXP.util.seed.create(),this.setTemperature(),this.setVegetation(),!0},e.drawVegetation=function(){for(var e=5,t=Math.round(Math.round(EXP.camera.x/32)/e)||0,n=Math.round(Math.round(EXP.camera.y/32)/e)||0,a=Math.ceil((EXP.engine.width/32+10)/e/2),i=Math.ceil((EXP.engine.height/32+10)/e/2),r=[],o=t-a;o<t+a;o++)for(var h=n-i;h<n+i;h++){for(var s=[],m=[],d,g,u,c,p=0;p<e;p++)u=Math.round((o+":"+h+":"+this.seed).randomBetween(this.atmosphere.vegetation.min,this.atmosphere.vegetation.max)),c=Math.round((o+":"+(h+1)+":"+this.seed).randomBetween(this.atmosphere.vegetation.min,this.atmosphere.vegetation.max)),g=(c-u)/(e-1),d=Math.round(u+g*p),s.push([o*e,h*e+p,d]);for(var v=0;v<e;v++)u=Math.round((o+1+":"+h+":"+this.seed).randomBetween(this.atmosphere.vegetation.min,this.atmosphere.vegetation.max)),c=Math.round((o+1+":"+(h+1)+":"+this.seed).randomBetween(this.atmosphere.vegetation.min,this.atmosphere.vegetation.max)),g=(c-u)/(e-1),d=Math.round(u+g*v),m.push([(o+1)*e,h*e+v,d]);for(var l=0;l<s.length;l++)for(var f=0;f<e;f++)g=(m[l][2]-s[l][2])/(e-1),d=Math.round(s[l][2]+g*f),r.push([o*e+f,h*e+l,d])}for(var x=0;x<r.length;x++)EXP.engine.ctx.drawImage(this.tilesheet,32*r[x][2],this.sprites.vegetation.grass.y,32,32,Math.round(32*r[x][0]+EXP.engine.width/2-16-EXP.camera.x),Math.round(32*r[x][1]+EXP.engine.height/2-16-EXP.camera.y),32,32)},e.render=function(){EXP.engine.ctx.fillStyle=this.color,EXP.engine.ctx.fillRect(0,0,EXP.engine.width,EXP.engine.height),this.drawVegetation()},e.setVegetation=function(){this.atmosphere.vegetation.max=this.seed.randomBetween(0,9),this.atmosphere.vegetation.min=this.seed.randomBetween(0,this.atmosphere.vegetation.max)},e.setToxicity=function(){var e=!0;this.atmosphere.toxic=e},e.setTemperature=function(){var e=-273,t=500;this.atmosphere.temperature=Math.round(this.seed.randomBetween(e,t))},e.setColor=function(){this.color=this.seed.color()},e.calculateSpriteSheetIndex=function(e,t,n,a,i,r,o,h,s){return e?[n<<0,r<<1,h<<2,i<<3,a<<4,s<<5,o<<6,t<<7].reduce(function(e,t){return e+t},0):0},e});