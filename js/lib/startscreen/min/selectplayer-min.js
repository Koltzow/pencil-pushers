define(function(){var r={active:!1,initiated:!1,stars:[],colors:["#43ffa3","#f526af","#23b1ff","#ff961a"],backgroundImage:new Image,characterThumbnail:new Image,characterBig:new Image,freeSlot:new Image,indicatorImage:new Image,counter:0,delay:0};return r.backgroundImage.src="images/splashscreen.png",r.freeSlot.src="images/freeslot.png",r.characterThumbnail.src="images/tilesheets/player/characters-thumbnail.png",r.characterBig.src="images/tilesheets/player/characters-big.png",r.indicatorImage.src="images/tilesheets/player/indicator-animated.png",r.update=function(){if(!this.initiated){this.initiated=!0;for(var r=0;r<100;r++)this.stars.push({x:Math.random()*EXP.engine.width,y:Math.random()*EXP.engine.height,s:3*Math.random()+1,w:Math.ceil(2*Math.random()),l:100*Math.random()})}for(var r=0;r<EXP.controller.controllers.length;r++)EXP.controller.controllers[r].connected&&(EXP.controller.controllers[r].buttons[0].click&&EXP.controller.controllers[r].ready&&(EXP.startscreen.active=!1,EXP.room.generate()),EXP.controller.controllers[r].buttons[0].click&&!EXP.controller.controllers[r].ready&&(EXP.controller.controllers[r].ready=!0,EXP.sound.play("menu")),EXP.controller.controllers[r].buttons[1].click&&EXP.controller.controllers[r].ready&&(EXP.controller.controllers[r].ready=!1,EXP.sound.play("hit")),EXP.controller.controllers[r].ready||((EXP.controller.controllers[r].stick.left||void 0!==EXP.controller.controllers[r].buttons[14]&&EXP.controller.controllers[r].buttons[14].click)&&EXP.controller.controllers[r].character--,(EXP.controller.controllers[r].stick.right||void 0!==EXP.controller.controllers[r].buttons[15]&&EXP.controller.controllers[r].buttons[15].click)&&EXP.controller.controllers[r].character++,EXP.controller.controllers[r].character=EXP.controller.controllers[r].character>EXP.data.characters.length-1?0:EXP.controller.controllers[r].character,EXP.controller.controllers[r].character=EXP.controller.controllers[r].character<0?EXP.data.characters.length-1:EXP.controller.controllers[r].character));for(var r=0;r<this.stars.length;r++)this.stars[r].x+=this.stars[r].s/2,this.stars[r].y-=this.stars[r].s,this.stars[r].l--,this.stars[r].x>EXP.engine.width&&(this.stars[r].x=0,this.stars[r].l=100*Math.random()),this.stars[r].y<0&&(this.stars[r].y=EXP.engine.height,this.stars[r].l=100*Math.random());this.delay++,this.delay>6&&(this.counter++,this.counter>3&&(this.counter=0),this.delay=0)},r.render=function(){EXP.engine.ctx.drawImage(this.backgroundImage,0,0,EXP.engine.width,EXP.engine.height);for(var r=0;r<this.stars.length;r++)EXP.engine.ctx.fillStyle="#F5C900",this.stars[r].l>0&&EXP.engine.ctx.fillRect(Math.round(this.stars[r].x),Math.round(this.stars[r].y),this.stars[r].w,this.stars[r].w);for(var r=0;r<EXP.controller.controllers.length;r++)EXP.engine.ctx.fillStyle="#260562",EXP.engine.ctx.fillRect(130*r+69,64,112,182),EXP.engine.ctx.fillStyle=this.colors[r],EXP.engine.ctx.fillRect(130*r+65+5,65,110,180),EXP.controller.controllers[r].connected?(EXP.engine.ctx.drawImage(this.characterBig,100*EXP.controller.controllers[r].character,0,100,170,130*r+65+10,70,100,170),EXP.engine.ctx.fillStyle=this.colors[r],EXP.engine.ctx.drawImage(this.indicatorImage,12*this.counter,7*r,12,7,12*r+58*EXP.controller.controllers[r].character+EXP.engine.width/2-48*EXP.data.characters.length/2-10*(EXP.data.characters.length-1)/2,270,12,7)):EXP.engine.ctx.drawImage(this.freeSlot,130*r+65+10,70,100,170);for(var t=0;t<EXP.data.characters.length;t++)EXP.engine.ctx.drawImage(this.characterThumbnail,48*t,0,48,48,58*t+EXP.engine.width/2-48*EXP.data.characters.length/2-10*(EXP.data.characters.length-1)/2,280,48,48)},r.reset=function(){for(var r=0;r<EXP.controller.controllers.length;r++)EXP.controller.controllers[r].character=r},r});